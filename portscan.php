<form method="post" > 
    <input type="text" name="domain" /> 
    <input type="submit" value="Go" />
</form>
<br/>
 
<?php
if(!empty($_POST['domain'])) {    
    //list of port numbers to scan
    $ports = array(21, 22, 23, 25, 53, 80, 389, 443, 8080,  110, 1433, 3306);

    $results = array();
    foreach($ports as $port) {
        if($pf = @fsockopen($_POST['domain'], $port, $err, $err_string, 1)) {
            $results[$port] = true;
            fclose($pf);
        } else {
            $results[$port] = false;
        }
    }
 
    foreach($results as $port=>$val)    {
        $prot = getservbyport($port,"tcp");
                echo "$port ($prot): ";
        if($val) {
            echo "<span style=\"color:green\">OK</span><br/>";
        }
        else {
            echo "<span style=\"color:red\">KO</span><br/>";
        }
    }
}
?>
